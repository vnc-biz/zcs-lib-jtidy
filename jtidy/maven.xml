<?xml version="1.0" encoding="UTF-8"?>
<project xmlns:j="jelly:core" xmlns:u="jelly:util" default="rebuild-all">

    <goal name="rebuild-all" prereqs="pom,clean,ant,dist" />

    <goal name="nightly" prereqs="multiproject:clean,multiproject:install,dist,copy-nightly,multiproject:site-deploy" />

    <preGoal name="dist:prepare-src-filesystem">
        <attainGoal name="ant" />
    </preGoal>

    <postGoal name="dist:prepare-src-filesystem">
        <copy todir="${maven.dist.src.assembly.dir}">
            <fileset dir=".">
                <include name="checkstyle.xml" />
            </fileset>
        </copy>
    </postGoal>

    <preGoal name="site:sshdeploy">
        <mkdir dir="${maven.build.dir}/docs/maven" />
        <copy file="${maven.build.dir}/${pom.artifactId}-${pom.currentVersion}.jar"
            todir="${maven.build.dir}/docs/maven/${pom.groupId}/jars" />
    </preGoal>

    <goal name="copy-nightly">
        <mkdir dir="${maven.build.dir}/docs/nightly" />
        <copy todir="${maven.build.dir}/docs/nightly">
            <fileset dir="${maven.build.dir}/distributions" />
        </copy>
    </goal>
</project>

